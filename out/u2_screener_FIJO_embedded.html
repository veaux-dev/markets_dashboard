<!DOCTYPE html>
<html lang="es"><head><meta charset="utf-8"><title>U2 Screener</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://cdn.datatables.net/2.1.8/css/dataTables.dataTables.min.css">
<link rel="stylesheet" href="https://cdn.datatables.net/buttons/3.1.2/css/buttons.dataTables.min.css">
<link rel="stylesheet" href="https://cdn.datatables.net/fixedheader/4.0.1/css/fixedHeader.dataTables.min.css">
<!-- <link rel="stylesheet" href="https://cdn.datatables.net/colreorder/2.1.2/css/colReorder.dataTables.min.css"> -->
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://cdn.datatables.net/2.1.8/js/dataTables.min.js"></script>
<script src="https://cdn.datatables.net/buttons/3.1.2/js/dataTables.buttons.min.js"></script>
<script src="https://cdn.datatables.net/buttons/3.1.2/js/buttons.html5.min.js"></script>
<script src="https://cdn.datatables.net/fixedheader/4.0.1/js/dataTables.fixedHeader.min.js"></script>
<!-- <script src="https://cdn.datatables.net/colreorder/2.1.2/js/dataTables.colReorder.min.js"></script> -->
<style>
  :root{ --tbl-font: 12px }
  body{ font-size: inherit }
  body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;margin:16px}
  h1{font-size:1.15rem;margin:0 0 10px}
  .controls{display:flex;flex-wrap:wrap;gap:10px;align-items:center;margin:10px 0 12px}
  .controls label{display:flex;gap:6px;align-items:center}
  .controls input,.controls select{padding:6px 8px}
  .controls button{padding:6px 10px;cursor:pointer}
  table.dataTable thead th{ white-space:normal; line-height:1.2; }
  .dt-center{text-align:center}
  .badge{padding:2px 6px;border-radius:6px;font-weight:600;font-size:.95em}
  .badge.green{background:#e6f4ea;color:#0b6b2b}
  .badge.red{background:#fde8e8;color:#a1121c}
  .badge.gray{background:#eef2f7;color:#39465a}
  .banner{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;margin:8px 0 12px;padding:10px 12px;
          background:#101318;border:1px solid #2a2f3a;border-radius:10px;color:#e6e6e6}
  .banner code{background:#0f172a;padding:2px 6px;border-radius:6px}
  .legend{margin:6px 0 12px;color:#6584aa;font-size:.92em;line-height:1.35}
  .legend ul{margin:6px 0 0 18px;padding:0}
  .legend li code{background:#0f172a;padding:1px 5px;border-radius:6px}
  #tbl thead tr.filters th{padding:4px 8px; background-image: none !important; cursor: default !important}
  /* Tambi√©n oculta los pseudo-elementos de orden */
  #tbl thead tr.filters th::before,#tbl thead tr.filters th::after {display: none !important;  content: none !important;}
  /* #tbl thead th{padding:4px 8px} */
  /* #tbl{table-layout: fixed;} */
  #tbl thead tr.filters input,#tbl thead tr.filters select{width:100%;box-sizing:border-box;padding:4px 8px}
  #tbl{ font-size: var(--tbl-font) }
  .pos{ color:#15803d; font-weight:600 }   /* verde */
  .neg{ color:#b91c1c; font-weight:600 }   /* rojo  */
  .neu{ color:#64748b }                    /* gris  */
  .chip{ padding:2px 6px; border-radius:6px; background:#0f172a; display:inline-block }
  .ticker-link{ color:#22c55e; text-decoration:none; font-weight:600 }
  .ticker-link:hover{ text-decoration:underline; color:#16a34a }
  /* #tbl td{padding: 0px 8px} */
  #toggleFundamentals{
    padding:6px 10px; border:1px solid #2a2f3a; border-radius:8px;
    background:#0f172a; color:#e5e7eb; cursor:pointer;

    .tt{ position:relative; cursor:help }
    .tt:hover .tt-card{ opacity:1; transform:translateY(0); pointer-events:auto }
    .tt-card{
      position:absolute; z-index:50; top:110%; left:0; min-width:280px;
      background:#0b1220; color:#e5e7eb; border:1px solid #1f2937; border-radius:10px;
      box-shadow:0 12px 30px rgba(0,0,0,.35); padding:10px 12px; font-size:.9em;
      opacity:0; transform:translateY(4px); transition:.16s ease; pointer-events:none;
    }
    .tt-card .k{color:#93c5fd} .tt-card .v{color:#f3f4f6}
  }
  #toggleFundamentals:hover{ background:#111827 }
  /* 1) Permite que el texto del t√≠tulo del header haga wrap y lo ‚Äúclampeamos‚Äù a 3 l√≠neas */
  #tbl.dataTable thead th .dt-column-title{
    white-space: normal !important;   /* rompe el nowrap del theme */
    overflow-wrap: break-word;          /* rompe palabras largas si hace falta */
    line-height: 1.1;
    display: -webkit-box;             /* line-clamp */
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 3;            /* <= m√°x 3 l√≠neas */
    line-clamp: 3;
    overflow: hidden;                 /* oculta lo que exceda */
  }

  /* 2) (Opcional) fija un ancho ‚Äúcorto‚Äù a columnas verbosas para que realmente envuelvan.
    Usa el √≠ndice que te da data-dt-column en tu dump. Ejemplos: */
  #tbl thead th[data-dt-column="15"] { width: 12ch; }  /* MACD slope3 norm  */
  #tbl thead th[data-dt-column="14"] { width: 10ch; }  /* MACD slope3       */
  #tbl thead th[data-dt-column="33"] { width: 12ch; }  /* Reacelera MACD    */
</style></head>
<body>
<h1>U2 Screener</h1>
<div class="banner" id="liveBanner">
  üìå Close intrad√≠a <strong id="tfUsed">1h</strong>
  <span id="asofDisplay" style="margin-left: 30%; font-size:0.95em; color:#9ca3af;">
  AsOf: <strong class="asof-value" style="color:#ef4444;">--</strong>
  </span>
  <span style="float:right; font-size:0.9em; color:#9ca3af;">
    √öltima actualizaci√≥n: <strong id="lastUpdate">--:--:--</strong>
  </span>
</div>

<div class="legend">
  <strong>Definiciones r√°pidas:</strong>
  <ul>
    <li><code>PriceNow</code>: √∫ltimo cierre de la vela intrad√≠a (p. ej., 1h).</li>
    <li><code>ClosePrev</code>: cierre oficial de <em>ayer</em> (diario).</li>
    <li><code>Close</code>: √∫ltima vela diaria (si el d√≠a no ha cerrado, puede ser parcial).</li>
    <li><code>Œî-1d(now)</code>: <code>PriceNow / ClosePrev - 1</code> ‚Üí variaci√≥n ‚Äúen momento‚Äù vs cierre de ayer.</li>
    <li><code>Œî-open(now)</code>: <code>PriceNow / OpenToday - 1</code> ‚Üí variaci√≥n desde la apertura de hoy.</li>
    <li><code>Œî-1d</code>, <code>Œî-2d</code>, <code>Œî-5d</code>: variaciones entre <strong>cierres diarios</strong> (ayer vs hace N sesiones).</li>
    <li><code>Œî-lf</code>, <code>Œî-pf</code>: variaciones <strong>semanales</strong> (viernes vs viernes).</li>
  </ul>
</div>
<div class="controls">
  <label>Buscar: <input type="search" id="globalSearch" placeholder="Buscar..."></label>
  <label>Bias:
    <select id="biasFilter"><option value="">(Todos)</option><option value="üü¢">üü¢</option><option value="üî¥">üî¥</option><option value="‚ö™">‚ö™</option></select>
  </label>
  <label>PhaseW:
    <select id="phaseFilter"><option value="">(Todos)</option><option>U2</option><option>U1/D3</option><option>D4</option><option>Mixta</option></select>
  </label>
  <button id="toggleColFilters">Mostrar/Ocultar filtros por columna</button>
  <button id="resetAll">Reset filtros</button>
  <button id="clearState">Borrar estado guardado</button>
  <button id="toggleFundamentals" title="Mostrar/ocultar columnas fundamentales largas"> Ocultar fund. </button>
  <label>Tama√±o:<input id="fontSlider" type="range" min="08" max="18" value="14" step="1" style="width:120px"></label>
</div>

<table id="tbl" class="display compact nowrap" style="width:100%">
  <thead>
    <tr class="headers"></tr>
    <tr class="filters" style="display:none;"></tr>
  </thead>
  <tbody></tbody>
</table>


<script>

let table;


const PRELOADED_EL   = document.getElementById('preloadedData');
const PRELOADED_DATA = PRELOADED_EL ? JSON.parse(PRELOADED_EL.textContent || '[]') : null;
const EMBEDDED_MODE  = Array.isArray(PRELOADED_DATA);


// === NUEVO SISTEMA DE LAYOUT ===================================
// Controla el orden, nombre y visibilidad de cada columna.
// Basta con modificar este array para reordenar u ocultar campos.
const LAYOUT = [
  { key:'Ticker', title:'Ticker', show:true },
  
  { key:'PriceNow', title:'Close intrad', show:true },
  { key:'Close', title:'Close (hoy)', show:true },
  { key:'ClosePrev', title:'Close (ayer)', show:true },
  { key:'Bias', title:'Bias', show:true },
  { key:'Œî-1d(now)', title:'Œî-1d (now)', show:true },
  { key:'Œî-open(now)', title:'Œî-open (now)', show:true },
  { key:'Œî-1d', title:'Œî-1d', show:true },
  { key:'Œî-2d', title:'Œî-2d', show:true },
  { key:'Œî-5d', title:'Œî-5d', show:true },
  { key:'Œî-lf', title:'Œî-lf', show:true },
  { key:'Œî-pf', title:'Œî-pf', show:true },
  { key:'RSI', title:'RSI', show:true },
  { key:'MACDh', title:'MACDh', show:true },
  { key:'MACD_slope3', title:'MACDh Slope', show:true },
  { key:'MACD_slope3_norm', title:'MACDh Slope (norm)', show:true },
  { key:'Sup20', title:'Support 20', show:true },
  { key:'Res20', title:'Resist. 20', show:true },
  { key:'Sup60', title:'Support 60', show:true },
  { key:'Res60', title:'Resist. 60', show:true },
  { key:'PhaseW', title:'Phase Weinstein', show:true },
  { key:'DiasFase', title:'D√≠as Fase', show:true },
  { key:'PhasePrev', title:'Phase Prev', show:true },
  { key:'PhaseChanged', title:'Phase Ch.', show:true },
  { key:'U2_entry', title:'U2 entry', show:true },
  { key:'Force', title:'Force', show:true },
  { key:'DistRes%', title:'DistRes%', show:true },
  { key:'TF', title:'TF', show:true },
  { key:'AsOf', title:'AsOf', show:true },
  { key:'AboveMA50', title:'MA50+', show:true },
  { key:'AboveMA200', title:'MA200+', show:true },
  { key:'BreakRes20', title:'Res20+', show:true },
  { key:'BreakRes60', title:'Res60+', show:true },
  { key:'ReaceleraMACD', title:'Reacelera MACD', show:true },
  { key:'DistMA50%', title:'DistMA50%', show:true },

  // Fundamentales
  { key:'Name', title:'Name', show:false },
  { key:'Asset', title:'Asset', show:false },
  { key:'Sector', title:'Sector', show:false },
  { key:'Industry', title:'Industry', show:false },
  { key:'MarketCap', title:'MarketCap', show:false },
  { key:'TrailingPE', title:'Trailing PE', show:false },
  { key:'ForwardPE', title:'Forward PE', show:false },
  { key:'PriceToBook', title:'Price / Book', show:false },
  { key:'EVtoEBITDA', title:'EV / EBITDA', show:false },
  { key:'ProfitMargin%', title:'Profit Margin %', show:false },
  { key:'ROE%', title:'ROE %', show:false },
  { key:'FreeCashFlow', title:'Free Cash Flow', show:false },
  { key:'TotalDebt', title:'Total Debt', show:false },
  { key:'DividendYield%', title:'Div. Yield %', show:false },
  { key:'PayoutRatio%', title:'Payout %', show:false },
  { key:'Beta', title:'Beta', show:false },
  { key:'ExpenseRatio%', title:'Expense Ratio %', show:false },
  { key:'AUM', title:'AUM', show:false },
  { key:'Category', title:'Category', show:false },
  { key:'FundYield%', title:'Fund Yield %', show:false },
  { key:'Ret3Y%', title:'Ret 3Y %', show:false },
  { key:'Ret5Y%', title:'Ret 5Y %', show:false },
  { key:'recommendationKey', title:'Reco Key', show:false },
  { key:'averageAnalystRating', title:'Avg Analyst Rating', show:false }
];

// Derivados para DataTables
const COLMAP  = LAYOUT.map(c => c.key);
const TITLES  = LAYOUT.map(c => c.title);
const VISIBLE = LAYOUT.map(c => c.show);

// --- 2Ô∏è‚É£ FORMATEADORES ---
function pct(v){ if(v==null||v==="")return ""; const n=Number(v); if(!isFinite(n))return ""; const s=n>0?"+":(n<0?"":""); return s+n.toFixed(1)+"%"; }
function smart(v){ if(v==null||v==="")return ""; const n=Number(v); if(!isFinite(n))return ""; const prec=Math.abs(n)>=1000?0:2; return n.toLocaleString(undefined,{minimumFractionDigits:prec,maximumFractionDigits:prec}); }
function pint(v){ if(v==null||v==="")return ""; const n=Number(v); if(!isFinite(n))return ""; return String(Math.round(n)); }
function sgn(v,d=2){ if(v==null||v==="")return ""; const n=Number(v); if(!isFinite(n))return ""; const s=n>0?"+":(n<0?"":""); return s+n.toFixed(d); }
function biasBadge(b){ if(b==="üü¢")return '<span class="badge green">üü¢</span>'; if(b==="üî¥")return '<span class="badge red">üî¥</span>'; return '<span class="badge gray">'+(b||"‚Äì")+'</span>'; }
function pctSpan(v){ if(v==null||v==="") return ""; const n=Number(v); if(!isFinite(n)) return ""; const cls=n>0?"pos":n<0?"neg":"neu"; const sgn=n>0?"+":(n<0?"":""); return `<span class="${cls}">${sgn}${n.toFixed(1)}%</span>`; }
function sgnSpan(v,d=2){ if(v==null||v==="") return ""; const n=Number(v); if(!isFinite(n)) return ""; const cls=n>0?"pos":n<0?"neg":"neu"; const sgn=n>0?"+":(n<0?"":""); return `<span class="${cls}">${sgn}${n.toFixed(d)}</span>`; }
function slopeNormChip(v){ if(v==null||v==="")return ""; const n=Number(v); if(!isFinite(n))return ""; const up=n>0,flat=n===0; const arrow=flat?"‚Üí":(up?"‚Üó":"‚Üò"); const cls=up?"pos":(!up&&!flat?"neg":"neu"); return `<span class="${cls}">${arrow} ${n.toFixed(2)}</span>`; }
function tickerLink(v){ const t=String(v||""); if(!t) return ""; const href=`triple_screen.html?ticker=${encodeURIComponent(t)}`; return `<a class="ticker-link" href="${href}" target="_blank" rel="noopener">${t}</a>`; }
function humanMoney(x){ const n=Number(x); if(!isFinite(n)) return ''; const ab=Math.abs(n); if(ab>=1e12)return (n/1e12).toFixed(2)+'T'; if(ab>=1e9)return (n/1e9).toFixed(2)+'B'; if(ab>=1e6)return (n/1e6).toFixed(2)+'M'; return n.toLocaleString(); }


// √çndices actuales (para referencia r√°pida)
/*
0 Ticker
1 PriceNow  2 Close(ayer)  3 Close(hoy)  4 Bias
5 Œî-1d(now) 6 Œî-open(now)
7 Œî-1d 8 Œî-2d 9 Œî-5d 10 Œî-lf 11 Œî-pf
12 RSI 13 MACDh 14 MACD_slope3 15 MACD_slope3_norm
16 Sup20 17 Res20 18 Sup60 19 Res60
20 PhaseW 21 DiasFase 22 PhasePrev 23 PhaseChanged 24 U2_entry
25 Force 26 DistRes% 27 TF 28 AsOf
29 AboveMA50 30 AboveMA200 31 BreakRes20 32 BreakRes60 33 ReaceleraMACD 34 DistMA50%
35 Name, 36 Asset, 37 Sector, 38 Industry,
39 MarketCap, 40 TrailingPE, 41 ForwardPE, 42 PriceToBook, 43 EVtoEBITDA,
44 ProfitMargin%, 45 ROE%, 46 FreeCashFlow, 47 TotalDebt,
48 DividendYield%, 49 PayoutRatio%, 50 Beta,
51 ExpenseRatio%, 52 AUM, 53 Category,
54 FundYield%, 55 Ret3Y%, 56 Ret5Y%,
57 recommendationKey, 58 averageAnalystRating
*/

// --- 3Ô∏è‚É£ DEFINICI√ìN DE FORMATEOS POR COLUMNA ---
const COLDEFS = [
  {targets:[4,20,22,23,24,27,28], className:'dt-center'},
  {targets:[1,2,3,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,25,26], type:'num'},
  {targets:[1,2,3,16,17,18,19], render:(d,t)=> t==='display'? smart(d):d},
  {targets:[12,21], render:(d,t)=> t==='display'? pint(d):d},
  {targets:13, render:(d,t)=> t==='display'? sgn(d,1):d},
  {targets:14, render:(d,t)=> t==='display'? sgn(d,3):d},
  {targets:15, render:(d,t)=> t==='display'? sgn(d,2):d},
  {targets:4,  render:(d,t)=> t==='display'? biasBadge(d):d},
  {targets:[5,6,7,8,9,10,11,25,26,34], render:(d,t)=> t==='display'? pctSpan(d):d},
  {targets:[13,14], render:(d,t)=> t==='display'? sgnSpan(d,1):d},
  {targets:[15], render:(d,t)=> t==='display'? slopeNormChip(d):d},
  {targets:[40,41,42,43,50], render:(d,t)=> t==='display'? sgn(d,2):d},
  {targets:[29,30,31,32,33,23,24], className:'dt-center'},
  {targets:[29,30,31,32,33,23,24], render:(d,t)=> t==='display' ? (d ? '‚úÖ' : '‚Äî') : d},
  {targets:[39,46,47,52], render:(d,t)=> t==='display'? humanMoney(d):d},
  {targets:[44,45,48,49,51,54,55,56], render:(d,t)=> t==='display'? pct(d,2):d},
  {targets:0, render:(d,t)=> t==='display' ? tickerLink(d) : d},
];


async function loadData() {
  try {
    const data = EMBEDDED_MODE
      ? PRELOADED_DATA
      : await (await fetch('u2_screener.json?_=' + Date.now())).json();
    const rows = Array.isArray(data) ? data.map(r => COLMAP.map(k => (r[k] ?? ""))) : [];

    // solo refresca filas
    table.clear().rows.add(rows).draw(false);

    // banner
    const tf   = data.find(r => r.TF)?.TF || '‚Äì';
    const asof = data.find(r => r.AsOf)?.AsOf || '‚Äì';
    const lastUpdate = document.getElementById('lastUpdate');
    const tfUsed     = document.getElementById('tfUsed');
    const asofDisplay = document.querySelector('#asofDisplay .asof-value');
    if (lastUpdate) lastUpdate.textContent = new Date().toLocaleTimeString();
    if (tfUsed)     tfUsed.textContent     = tf;
    if (asofDisplay) asofDisplay.textContent = asof;
  } catch (err) {
    console.error("‚ùå Error al cargar JSON:", err);
  }
}

function init() {


  // 1) inicializa DataTable VAC√çO (sin esperar al fetch)
  table = new DataTable('#tbl', {
    data: [],
    columns: COLMAP.map((k,i)=>({ title: TITLES[i] || k })),
    pageLength: 50,
    order: [],
    stateSave: true,
    fixedHeader: true,
    colReorder: { realtime: false },
    orderCellsTop: true,
    autoWidth: true,          // te lo dejo como quer√≠as
    deferRender: true,        // ayuda a que no parpadee
    dom: 'Bfrtip',            // sin Q
    buttons: ['copy', 'csv', 'excel'],
    language: { url: 'https://cdn.datatables.net/plug-ins/2.1.8/i18n/es-ES.json' },
    columnDefs: COLDEFS,
    rowCallback: function (row, data) {
      const iTicker = COLMAP.indexOf('Ticker');
      if (iTicker < 0) return;
      const tip = [
        `Name: ${data[COLMAP.indexOf('Name')] || ''}`,
        `Industry: ${data[COLMAP.indexOf('Industry')] || ''}`,
        `Market Cap: ${humanMoney(data[COLMAP.indexOf('MarketCap')])}`,
        `Free Cash Flow: ${humanMoney(data[COLMAP.indexOf('FreeCashFlow')])}`,
        `Total Debt: ${humanMoney(data[COLMAP.indexOf('TotalDebt')])}`
      ].join('\n');
      $('td', row).eq(iTicker).attr('title', tip);
    }
  });

  // crea headers una sola vez
  if (!document.querySelector('#tbl thead th')) {
    document.querySelector('#tbl thead').innerHTML =
  '<tr class="headers">' + TITLES.map(t => `<th>${t}</th>`).join('') + '</tr>';
  }

  table.on('init', function () {
    buildColumnFilters();                 // crea los inputs cuando DT ya tom√≥ control del thead
    refreshAllHeaderTooltips();           // tooltips en header normal + fijo
    table.columns.adjust().draw(false);   // realinea
  });
  
    // ‚¨áÔ∏è AQU√ç va el de reordenar columnas (solo si ColReorder est√° cargado)
  table.on('column-reorder', function () {
    const $thead = $(table.table().header()).closest('thead');
    $thead.find('tr.filters').remove();
    buildColumnFilters();
    table.columns.adjust().draw(false);
    if (table.fixedHeader && table.fixedHeader.adjust) table.fixedHeader.adjust();
  });

  // 3) primera carga de datos y refrescos
  loadData();
  if (!EMBEDDED_MODE) setInterval(loadData, 60000);
}



// arranca ya (el script est√° al final del <body>, el DOM ya est√° listo)
init();

table.on('column-reorder draw', refreshAllHeaderTooltips);

function setHeaderTooltips(root) {
    const H = $(root).find('thead th');
    H.eq(1).attr('title','√öltimo close de la vela intrad√≠a (p.ej. 1h) = PriceNow');
    H.eq(3).attr('title','Cierre oficial de AYER (diario)');
    H.eq(2).attr('title','√öltima vela DIARIA (puede ser parcial si a√∫n no cierra) = Close 1d Hoy');

    H.eq(5).attr('title','PriceNow vs Close(ayer)');
    H.eq(6).attr('title','PriceNow vs Open(hoy)');
    H.eq(7).attr('title','Close 1d Hoy vs Close session -1 (ayer)');
    H.eq(8).attr('title','Close 1d Hoy vs Close session -2');
    H.eq(9).attr('title','Close 1d Hoy vs Close session -5');
    H.eq(10).attr('title','Close 1d Hoy vs Close Viernes pasado');
    H.eq(11).attr('title','Close 1d Hoy vs Close Viernes antepasado');

    H.eq(13).attr('title','Histograma MACD (impulso), con signo');
    H.eq(14).attr('title','Pendiente del MACDh (absoluta)');
    H.eq(15).attr('title','Pendiente normalizada: comparables entre tickers (no %)');

    H.eq(16).attr('title','Soporte Donchian 20 (corto plazo)');
    H.eq(17).attr('title','Resistencia Donchian 20 (corto plazo)');
    H.eq(18).attr('title','Soporte Donchian 60 (medio plazo)');
    H.eq(19).attr('title','Resistencia Donchian 60 (medio plazo)');

    H.eq(29).attr('title','Close(hoy) ‚â• MA50 (diario)');
    H.eq(30).attr('title','Close(hoy) ‚â• MA200 (diario)');
    H.eq(31).attr('title','Close(hoy) ‚â• Res20');
    H.eq(32).attr('title','Close(hoy) ‚â• Res60');
    H.eq(33).attr('title','MACDh>0 y slope_norm>0');
    H.eq(34).attr('title','Distancia a MA50 diaria en %');

    H.eq(39).attr('title','Capitalizaci√≥n de mercado');
    H.eq(40).attr('title','P/E trailing (12m)');
    H.eq(41).attr('title','P/E forward (estimado)');
    H.eq(42).attr('title','Precio / Valor en libros');
    H.eq(43).attr('title','Enterprise Value / EBITDA');
    H.eq(44).attr('title','Margen neto %');
    H.eq(45).attr('title','Return on Equity %');
    H.eq(48).attr('title','Rendimiento de dividendo %');
    H.eq(49).attr('title','Payout de utilidades %');
    H.eq(51).attr('title','Gasto anual del fondo/ETF %');
    H.eq(57).attr('title','Clave de recomendaci√≥n (buy/hold/sell)');
    H.eq(58).attr('title','Promedio rating analistas (menor=mejor)');
}

function refreshAllHeaderTooltips(){
  setHeaderTooltips($('#tbl'));                         // header normal
  $('.dtfh-floatingparent').each(function(){ setHeaderTooltips(this); });  // header fijo

}

// Filtros r√°pidos
$('#globalSearch').on('input', function(){ table.search(this.value).draw(); });
$('#biasFilter').on('change', function(){ const v=this.value; table.column(4).search(v?`^${v}$`:"",true,false).draw(); });
$('#phaseFilter').on('change', function(){ const v=this.value; table.column(20).search(v?`^${v}$`:"",true,false).draw(); });

// --- toggle filtros (header real + header flotante) ---
const FILTERS_KEY = 'filters_on';

function setFiltersVisible(v){
  const disp = v ? '' : 'none';
  // thead REAL que usa DataTables
  $(table.table().header()).closest('thead').find('tr.filters').css('display', disp);
  // thead CLONADO de FixedHeader (si est√°)
  $('.dtfh-floatingparent thead tr.filters').css('display', disp);
  table.columns.adjust().draw(false);
  if (table.fixedHeader && table.fixedHeader.adjust) table.fixedHeader.adjust();
  localStorage.setItem(FILTERS_KEY, v ? '1' : '0');
}

let filtersVisible = (localStorage.getItem(FILTERS_KEY) === '1');

$('#toggleColFilters').off('click.toggle').on('click.toggle', function(){
  filtersVisible = !filtersVisible;
  setFiltersVisible(filtersVisible);
});


function buildColumnFilters() {
  const $thead = $(table.table().header()).closest('thead'); // usa el thead REAL de DataTables
  const $headers = $thead.find('tr.headers');
  let $filters = $thead.find('tr.filters');

  if (!$filters.length) {
    $filters = $('<tr class="filters"></tr>').appendTo($thead);
  }
  $filters.empty();

  $headers.find('th').each(function (i) {
    // Bias column
    if (i === COLMAP.indexOf('Bias')) {
      $filters.append(`<th><select data-col="${i}">
        <option value="">(Todos)</option><option>üü¢</option><option>üî¥</option><option>‚ö™</option>
      </select></th>`);
    }
    // PhaseW column
    else if (i === COLMAP.indexOf('PhaseW')) {
      $filters.append(`<th><select data-col="${i}">
        <option value="">(Todos)</option><option>U2</option><option>U1/D3</option><option>D4</option><option>Mixta</option>
      </select></th>`);
    }
    // Default text input
    else {
      $filters.append(`<th><input type="text" data-col="${i}" placeholder="Filtrar..."></th>`);
    }
  });

 
  // evita listeners duplicados
  $thead.off('keyup.filter change.filter');

  // input de texto (delegado)
  $thead.on('keyup.filter change.filter', 'tr.filters input', function () {
    const c = +this.dataset.col;
    if (Number.isInteger(c)) table.column(c).search(this.value).draw();
  });

  // select exact match (delegado)
  $thead.on('change.filter', 'tr.filters select', function () {
    const c = +this.dataset.col, v = this.value;
    if (Number.isInteger(c)) table.column(c).search(v ? `^${v}$` : "", true, false).draw();
  });
  // üö´ Desactiva sorting en esa fila (importante)
  $filters.find('th')
    .removeClass('sorting sorting_asc sorting_desc dt-orderable-asc dt-orderable-desc')
    .css('cursor', 'default')
    .off('click.DT');

  table.columns.adjust().draw(false);
  if (table.fixedHeader && table.fixedHeader.adjust) table.fixedHeader.adjust();
}

// --- FIX: evita sorting al hacer click en los inputs/select de la fila de filtros ---
$('#tbl thead').on('click', 'tr.filters th', function(e) {
  e.stopImmediatePropagation(); // detiene el evento antes de que DataTables lo use
});

$('#resetAll').on('click', function(){
  $('#globalSearch').val(''); $('#biasFilter').val(''); $('#phaseFilter').val('');
  table.search(''); table.columns().search(''); table.order([]).draw();
  $('#tbl thead tr.filters input').val(''); $('#tbl thead tr.filters select').val('');
});
$('#clearState').on('click', function(){ table.state.clear(); location.reload(); });

// Columnas a ocultar/mostrar con el bot√≥n
const FUND_KEYS = [
  'Name','Sector','Industry','MarketCap',
  'FreeCashFlow','TotalDebt','AUM','Category'
];

// Mapa nombre->√≠ndice seg√∫n COLMAP
const IDX = Object.fromEntries(COLMAP.map((k,i)=>[k,i]));
const FUND_IDX = FUND_KEYS.map(k => IDX[k]).filter(i => i >= 0);

// Funci√≥n para aplicar visibilidad y actualizar bot√≥n + persistencia
function setFundamentalsVisible(visible){
  if (!table) return;
  const idx = FUND_KEYS.map(k => COLMAP.indexOf(k)).filter(i => i >= 0);
  idx.forEach(i => table.column(i).visible(visible, false));
  table.columns.adjust().draw(false);
  localStorage.setItem('fundColsVisible', visible ? '1' : '0');
  document.getElementById('toggleFundamentals').textContent = visible ? 'Ocultar fund.' : 'Mostrar fund.';
}

// Estado inicial
const savedfund = localStorage.getItem('fundColsVisible');
setFundamentalsVisible(savedfund === '1');


// Click para alternar
document.getElementById('toggleFundamentals').addEventListener('click', () => {
  const idx = COLMAP.indexOf(FUND_KEYS[0]);
  const visible = table.column(idx).visible();
  setFundamentalsVisible(!visible);
});

// ---- Control de tama√±o de fuente ----
const slider = document.getElementById('fontSlider');
if (slider) {
  const saved = localStorage.getItem('tblFontPx');
  if (saved) {
    document.documentElement.style.setProperty('--tbl-font', saved+'px');
    slider.value = saved;
  }
  slider.addEventListener('input', e => {
    const v = e.target.value;
    document.documentElement.style.setProperty('--tbl-font', v+'px');
    localStorage.setItem('tblFontPx', v);
  });
}
</script>
<script id="preloadedData" type="application/json">[
  {
    "Ticker": "AAPL",
    "Close": 259.37,
    "Bias": "‚ö™",
    "Œî-1d": 0.127388264893602,
    "Œî-2d": -0.3687594609127487,
    "Œî-5d": -4.2950497136633565,
    "Œî-lf": 0.0,
    "Œî-pf": -4.2950497136633565,
    "RSI": 27.271241182389126,
    "MACDh": -1.8289081172080501,
    "Sup20": 259.0400085449219,
    "Res20": 278.2799987792969,
    "Sup60": 247.21035766601562,
    "Res60": 286.19000244140625,
    "PhaseW": "Mixta",
    "Force": 11.412748915619918,
    "DiasFase": 23,
    "PhasePrev": "U2",
    "PhaseChanged": false,
    "U2_entry": false,
    "TF": "1h",
    "AsOf": "2026-01-09 20:30",
    "PriceNow": 259.35,
    "ClosePrev": 259.04,
    "Œî-1d(now)": 0.1,
    "Œî-open(now)": 0.1,
    "MACD_slope3": -0.159892,
    "MACD_slope3_norm": -0.10483569377109299,
    "AboveMA50": false,
    "AboveMA200": true,
    "BreakRes20": false,
    "BreakRes60": false,
    "ReaceleraMACD": false,
    "DistMA50%": -4.845999730345508,
    "Support": 255.6999969482422,
    "Resist.": 280.1499938964844,
    "Name": "Apple",
    "Asset": "Stock",
    "Sector": "Technology",
    "Industry": "Consumer Electronics",
    "MarketCap": 3849151840256.0,
    "TrailingPE": 34.768097,
    "ForwardPE": 28.341707,
    "PriceToBook": 51.967537,
    "EVtoEBITDA": 26.842,
    "ProfitMargin%": 0.26915002,
    "ROE%": 1.7142199,
    "FreeCashFlow": 78862254080.0,
    "TotalDebt": 112377004032.0,
    "DividendYield%": 0.4,
    "PayoutRatio%": 0.1367,
    "Beta": 1.093,
    "ExpenseRatio%": null,
    "AUM": null,
    "Category": "",
    "FundYield%": null,
    "Ret3Y%": null,
    "Ret5Y%": null,
    "recommendationKey": "buy",
    "averageAnalystRating": "2.0 - Buy"
  },
  {
    "Ticker": "MSFT",
    "Close": 479.28,
    "Bias": "‚ö™",
    "Œî-1d": 0.24471637564189574,
    "Œî-2d": -0.8666520013293488,
    "Œî-5d": 1.340549817135872,
    "Œî-lf": 0.0,
    "Œî-pf": 1.340549817135872,
    "RSI": 45.48244309153982,
    "MACDh": 0.17166028782367482,
    "Sup20": 472.8500061035156,
    "Res20": 488.0199890136719,
    "Sup60": 472.1199951171875,
    "Res60": 541.057373046875,
    "PhaseW": "Mixta",
    "Force": 0.06476655886855642,
    "DiasFase": 47,
    "PhasePrev": "U2",
    "PhaseChanged": false,
    "U2_entry": false,
    "TF": "1h",
    "AsOf": "2026-01-09 20:30",
    "PriceNow": 479.2,
    "ClosePrev": 478.11,
    "Œî-1d(now)": 0.2,
    "Œî-open(now)": 1.1,
    "MACD_slope3": 0.103304,
    "MACD_slope3_norm": 0.6137838810045575,
    "AboveMA50": false,
    "AboveMA200": true,
    "BreakRes20": false,
    "BreakRes60": false,
    "ReaceleraMACD": true,
    "DistMA50%": -2.264522433500238,
    "Support": 469.5,
    "Resist.": 489.70001220703125,
    "Name": "Microsoft",
    "Asset": "Stock",
    "Sector": "Technology",
    "Industry": "Software - Infrastructure",
    "MarketCap": 3562567892992.0,
    "TrailingPE": 34.088192,
    "ForwardPE": 25.571993,
    "PriceToBook": 9.813268,
    "EVtoEBITDA": 21.461,
    "ProfitMargin%": 0.35707,
    "ROE%": 0.32241002,
    "FreeCashFlow": 53327376384.0,
    "TotalDebt": 120375001088.0,
    "DividendYield%": 0.76,
    "PayoutRatio%": 0.2361,
    "Beta": 1.073,
    "ExpenseRatio%": null,
    "AUM": null,
    "Category": "",
    "FundYield%": null,
    "Ret3Y%": null,
    "Ret5Y%": null,
    "recommendationKey": "strong_buy",
    "averageAnalystRating": "1.3 - Strong Buy"
  },
  {
    "Ticker": "NVDA",
    "Close": 184.86,
    "Bias": "‚ö™",
    "Œî-1d": -0.09727230993946678,
    "Œî-2d": -2.2473692487352093,
    "Œî-5d": -2.1127907673865742,
    "Œî-lf": 0.0,
    "Œî-pf": -2.1127907673865742,
    "RSI": 49.70354285628374,
    "MACDh": 0.17530841231935934,
    "Sup20": 170.94000244140625,
    "Res20": 190.52999877929688,
    "Sup60": 170.94000244140625,
    "Res60": 207.02847290039062,
    "PhaseW": "Mixta",
    "Force": 13.98956527760291,
    "DiasFase": 2,
    "PhasePrev": "U2",
    "PhaseChanged": false,
    "U2_entry": false,
    "TF": "1h",
    "AsOf": "2026-01-09 20:30",
    "PriceNow": 184.85,
    "ClosePrev": 185.04,
    "Œî-1d(now)": -0.1,
    "Œî-open(now)": -0.1,
    "MACD_slope3": -0.217961,
    "MACD_slope3_norm": -0.33626327946143036,
    "AboveMA50": false,
    "AboveMA200": true,
    "BreakRes20": false,
    "BreakRes60": false,
    "ReaceleraMACD": false,
    "DistMA50%": -0.8096516567874024,
    "Support": 170.30999755859375,
    "Resist.": 193.6300048828125,
    "Name": "NVIDIA",
    "Asset": "Stock",
    "Sector": "Technology",
    "Industry": "Semiconductors",
    "MarketCap": 4500786511872.0,
    "TrailingPE": 45.870964,
    "ForwardPE": 24.431248,
    "PriceToBook": 37.788223,
    "EVtoEBITDA": 39.457,
    "ProfitMargin%": 0.53007,
    "ROE%": 1.07359,
    "FreeCashFlow": 53282873344.0,
    "TotalDebt": 10821999616.0,
    "DividendYield%": 0.02,
    "PayoutRatio%": 0.0099,
    "Beta": 2.314,
    "ExpenseRatio%": null,
    "AUM": null,
    "Category": "",
    "FundYield%": null,
    "Ret3Y%": null,
    "Ret5Y%": null,
    "recommendationKey": "strong_buy",
    "averageAnalystRating": "1.3 - Strong Buy"
  },
  {
    "Ticker": "GOOGL",
    "Close": 328.57,
    "Bias": "üü¢",
    "Œî-1d": 0.961776321082719,
    "Œî-2d": 2.046709768629218,
    "Œî-5d": 4.25829404653022,
    "Œî-lf": 0.0,
    "Œî-pf": 4.25829404653022,
    "RSI": 69.0298994520998,
    "MACDh": 0.7451479478580127,
    "Sup20": 296.7200012207031,
    "Res20": 328.57000732421875,
    "Sup60": 250.29627990722656,
    "Res60": 328.57000732421875,
    "PhaseW": "U2",
    "Force": 48.09494532048235,
    "DiasFase": 2,
    "PhasePrev": "Mixta",
    "PhaseChanged": false,
    "U2_entry": false,
    "TF": "1h",
    "AsOf": "2026-01-09 20:30",
    "PriceNow": 328.48,
    "ClosePrev": 325.44,
    "Œî-1d(now)": 0.9,
    "Œî-open(now)": 0.4,
    "MACD_slope3": 0.457946,
    "MACD_slope3_norm": 0.9360282051197544,
    "AboveMA50": true,
    "AboveMA200": true,
    "BreakRes20": true,
    "BreakRes60": true,
    "ReaceleraMACD": true,
    "DistMA50%": 8.118688316493605,
    "Support": 296.1199951171875,
    "Resist.": 330.8299865722656,
    "Name": "Alphabet Inc.",
    "Asset": "Stock",
    "Sector": "Communication Services",
    "Industry": "Internet Content & Information",
    "MarketCap": 3979679891456.0,
    "TrailingPE": 32.467392,
    "ForwardPE": 29.2448,
    "PriceToBook": 10.257235,
    "EVtoEBITDA": 26.677,
    "ProfitMargin%": 0.32233003,
    "ROE%": 0.3545,
    "FreeCashFlow": 47997751296.0,
    "TotalDebt": 44195000320.0,
    "DividendYield%": 0.26,
    "PayoutRatio%": 0.0809,
    "Beta": 1.086,
    "ExpenseRatio%": null,
    "AUM": null,
    "Category": "",
    "FundYield%": null,
    "Ret3Y%": null,
    "Ret5Y%": null,
    "recommendationKey": "strong_buy",
    "averageAnalystRating": "1.5 - Strong Buy"
  },
  {
    "Ticker": "AMZN",
    "Close": 247.38,
    "Bias": "‚ö™",
    "Œî-1d": 0.4425724253495522,
    "Œî-2d": 2.4093423509855105,
    "Œî-5d": 9.218545202124728,
    "Œî-lf": 0.0,
    "Œî-pf": 9.218545202124728,
    "RSI": 69.19749257204997,
    "MACDh": 2.0646035041019646,
    "Sup20": 221.27000427246094,
    "Res20": 247.3800048828125,
    "Sup60": 213.0399932861328,
    "Res60": 254.0,
    "PhaseW": "U2",
    "Force": 13.42698676481804,
    "DiasFase": 5,
    "PhasePrev": "U1/D3",
    "PhaseChanged": false,
    "U2_entry": false,
    "TF": "1h",
    "AsOf": "2026-01-09 20:30",
    "PriceNow": 247.35,
    "ClosePrev": 246.29,
    "Œî-1d(now)": 0.4,
    "Œî-open(now)": 1.1,
    "MACD_slope3": 0.343491,
    "MACD_slope3_norm": 0.2541200743820225,
    "AboveMA50": true,
    "AboveMA200": true,
    "BreakRes20": true,
    "BreakRes60": false,
    "ReaceleraMACD": true,
    "DistMA50%": 6.025515302946571,
    "Support": 220.99000549316406,
    "Resist.": 247.86000061035156,
    "Name": "Amazon.com",
    "Asset": "Stock",
    "Sector": "Consumer Cyclical",
    "Industry": "Internet Retail",
    "MarketCap": 2644545634304.0,
    "TrailingPE": 34.990097,
    "ForwardPE": 31.463036,
    "PriceToBook": 7.152398,
    "EVtoEBITDA": 19.321,
    "ProfitMargin%": 0.11063,
    "ROE%": 0.24327,
    "FreeCashFlow": 26080000000.0,
    "TotalDebt": 160437993472.0,
    "DividendYield%": null,
    "PayoutRatio%": 0.0,
    "Beta": 1.376,
    "ExpenseRatio%": null,
    "AUM": null,
    "Category": "",
    "FundYield%": null,
    "Ret3Y%": null,
    "Ret5Y%": null,
    "recommendationKey": "strong_buy",
    "averageAnalystRating": "1.3 - Strong Buy"
  },
  {
    "Ticker": "TSLA",
    "Close": 445.01,
    "Bias": "‚ö™",
    "Œî-1d": 2.113359850994656,
    "Œî-2d": 3.1524549704618154,
    "Œî-5d": 1.5842222305509024,
    "Œî-lf": 0.0,
    "Œî-pf": 1.5842222305509024,
    "RSI": 47.56146717457721,
    "MACDh": -4.980130063383499,
    "Sup20": 431.4100036621094,
    "Res20": 489.8800048828125,
    "Sup60": 391.0899963378906,
    "Res60": 489.8800048828125,
    "PhaseW": "Mixta",
    "Force": 22.00460002850857,
    "DiasFase": 9,
    "PhasePrev": "U2",
    "PhaseChanged": false,
    "U2_entry": false,
    "TF": "1h",
    "AsOf": "2026-01-09 20:30",
    "PriceNow": 444.99,
    "ClosePrev": 435.8,
    "Œî-1d(now)": 2.1,
    "Œî-open(now)": 2.1,
    "MACD_slope3": 0.277933,
    "MACD_slope3_norm": 0.049749769603166995,
    "AboveMA50": true,
    "AboveMA200": true,
    "BreakRes20": false,
    "BreakRes60": false,
    "ReaceleraMACD": false,
    "DistMA50%": 0.16967866298194245,
    "Support": 424.3699951171875,
    "Resist.": 498.8299865722656,
    "Name": "Tesla",
    "Asset": "Stock",
    "Sector": "Consumer Cyclical",
    "Industry": "Auto Manufacturers",
    "MarketCap": 1480022818816.0,
    "TrailingPE": 309.03473,
    "ForwardPE": 203.83104,
    "PriceToBook": 18.497381,
    "EVtoEBITDA": 132.084,
    "ProfitMargin%": 0.05314,
    "ROE%": 0.06791,
    "FreeCashFlow": 2979249920.0,
    "TotalDebt": 13788000256.0,
    "DividendYield%": null,
    "PayoutRatio%": 0.0,
    "Beta": 1.835,
    "ExpenseRatio%": null,
    "AUM": null,
    "Category": "",
    "FundYield%": null,
    "Ret3Y%": null,
    "Ret5Y%": null,
    "recommendationKey": "hold",
    "averageAnalystRating": "2.6 - Hold"
  },
  {
    "Ticker": "META",
    "Close": 653.06,
    "Bias": "üî¥",
    "Œî-1d": 1.0834907015528694,
    "Œî-2d": 0.6736646319105644,
    "Œî-5d": 0.40743908050031585,
    "Œî-lf": 0.0,
    "Œî-pf": 0.40743908050031585,
    "RSI": 49.173530701751424,
    "MACDh": -1.4060749260668135,
    "Sup20": 643.7050170898438,
    "Res20": 667.5499877929688,
    "Sup60": 588.669921875,
    "Res60": 751.0574340820312,
    "PhaseW": "U1/D3",
    "Force": -3.0955832715224063,
    "DiasFase": 29,
    "PhasePrev": "Mixta",
    "PhaseChanged": false,
    "U2_entry": false,
    "TF": "1h",
    "AsOf": "2026-01-09 20:30",
    "PriceNow": 653.04,
    "ClosePrev": 646.06,
    "Œî-1d(now)": 1.1,
    "Œî-open(now)": 1.2,
    "MACD_slope3": -0.436287,
    "MACD_slope3_norm": -0.5461178641916814,
    "AboveMA50": true,
    "AboveMA200": false,
    "BreakRes20": false,
    "BreakRes60": false,
    "ReaceleraMACD": false,
    "DistMA50%": 1.5538941175875731,
    "Support": 635.719970703125,
    "Resist.": 710.4206277669183,
    "Name": "Meta Platforms",
    "Asset": "Stock",
    "Sector": "Communication Services",
    "Industry": "Internet Content & Information",
    "MarketCap": 1646055784448.0,
    "TrailingPE": 28.883678,
    "ForwardPE": 21.46915,
    "PriceToBook": 8.483501,
    "EVtoEBITDA": 16.616,
    "ProfitMargin%": 0.30892,
    "ROE%": 0.32643002,
    "FreeCashFlow": 18617749504.0,
    "TotalDebt": 51059998720.0,
    "DividendYield%": 0.33,
    "PayoutRatio%": 0.091800004,
    "Beta": 1.287,
    "ExpenseRatio%": null,
    "AUM": null,
    "Category": "",
    "FundYield%": null,
    "Ret3Y%": null,
    "Ret5Y%": null,
    "recommendationKey": "strong_buy",
    "averageAnalystRating": "1.4 - Strong Buy"
  },
  {
    "Ticker": "SOXL",
    "Close": 53.95,
    "Bias": "‚ö™",
    "Œî-1d": 8.66062256779443,
    "Œî-2d": 3.1746028272093163,
    "Œî-5d": 14.204061909530473,
    "Œî-lf": 0.0,
    "Œî-pf": 14.204061909530473,
    "RSI": 64.0934695302082,
    "MACDh": 0.9894460527538596,
    "Sup20": 36.0099983215332,
    "Res20": 54.0099983215332,
    "Sup60": 30.809999465942383,
    "Res60": 54.0099983215332,
    "PhaseW": "U2",
    "Force": 85.35328003053719,
    "DiasFase": 6,
    "PhasePrev": "Mixta",
    "PhaseChanged": false,
    "U2_entry": false,
    "TF": "1h",
    "AsOf": "2026-01-09 20:30",
    "PriceNow": 53.91,
    "ClosePrev": 49.65,
    "Œî-1d(now)": 8.6,
    "Œî-open(now)": 5.5,
    "MACD_slope3": 0.023176,
    "MACD_slope3_norm": 0.02701323577680803,
    "AboveMA50": true,
    "AboveMA200": true,
    "BreakRes20": false,
    "BreakRes60": false,
    "ReaceleraMACD": true,
    "DistMA50%": 24.494638682315227,
    "Support": 35.70000076293945,
    "Resist.": 54.7599983215332,
    "Name": "Direxion Daily Semiconductor Bull 3X Shares",
    "Asset": "ETF",
    "Sector": "",
    "Industry": "",
    "MarketCap": null,
    "TrailingPE": 46.919937,
    "ForwardPE": null,
    "PriceToBook": null,
    "EVtoEBITDA": null,
    "ProfitMargin%": null,
    "ROE%": null,
    "FreeCashFlow": null,
    "TotalDebt": null,
    "DividendYield%": 0.34,
    "PayoutRatio%": null,
    "Beta": null,
    "ExpenseRatio%": null,
    "AUM": 12677213184.0,
    "Category": "Trading--Leveraged Equity",
    "FundYield%": 0.0034,
    "Ret3Y%": 0.6708755,
    "Ret5Y%": 0.074162796,
    "recommendationKey": "",
    "averageAnalystRating": ""
  },
  {
    "Ticker": "SOXS",
    "Close": 2.36,
    "Bias": "‚ö™",
    "Œî-1d": -8.171207922250678,
    "Œî-2d": -3.6734755443363687,
    "Œî-5d": -14.181821996515442,
    "Œî-lf": 0.0,
    "Œî-pf": -14.181821996515442,
    "RSI": 33.90001481752573,
    "MACDh": -0.048064954153362954,
    "Sup20": 2.359999895095825,
    "Res20": 3.710271120071411,
    "Sup60": 2.359999895095825,
    "Res60": 4.65757417678833,
    "PhaseW": "D4",
    "Force": -73.85746139196141,
    "DiasFase": 6,
    "PhasePrev": "Mixta",
    "PhaseChanged": false,
    "U2_entry": false,
    "TF": "1h",
    "AsOf": "2026-01-09 20:30",
    "PriceNow": 2.36,
    "ClosePrev": 2.57,
    "Œî-1d(now)": -8.4,
    "Œî-open(now)": -5.8,
    "MACD_slope3": -0.001482,
    "MACD_slope3_norm": -0.036189669521680345,
    "AboveMA50": false,
    "AboveMA200": false,
    "BreakRes20": false,
    "BreakRes60": false,
    "ReaceleraMACD": false,
    "DistMA50%": -28.444234061993168,
    "Support": 2.309999942779541,
    "Resist.": 3.7497420518915363,
    "Name": "Direxion Daily Semiconductor Bear 3X Shares",
    "Asset": "ETF",
    "Sector": "",
    "Industry": "",
    "MarketCap": null,
    "TrailingPE": null,
    "ForwardPE": null,
    "PriceToBook": null,
    "EVtoEBITDA": null,
    "ProfitMargin%": null,
    "ROE%": null,
    "FreeCashFlow": null,
    "TotalDebt": null,
    "DividendYield%": 10.75,
    "PayoutRatio%": null,
    "Beta": null,
    "ExpenseRatio%": null,
    "AUM": 1070985600.0,
    "Category": "Trading--Inverse Equity",
    "FundYield%": 0.1075,
    "Ret3Y%": -0.7949288,
    "Ret5Y%": -0.7136484,
    "recommendationKey": "",
    "averageAnalystRating": ""
  },
  {
    "Ticker": "SOXX",
    "Close": 328.78,
    "Bias": "‚ö™",
    "Œî-1d": 2.8787823373135124,
    "Œî-2d": 1.1973233880606449,
    "Œî-5d": 4.810480480871959,
    "Œî-lf": 0.0,
    "Œî-pf": 4.810480480871959,
    "RSI": 65.34356921497115,
    "MACDh": 2.1235029180722895,
    "Sup20": 285.2300109863281,
    "Res20": 328.7799987792969,
    "Sup60": 267.707763671875,
    "Res60": 328.7799987792969,
    "PhaseW": "U2",
    "Force": 31.992166615133154,
    "DiasFase": 6,
    "PhasePrev": "Mixta",
    "PhaseChanged": false,
    "U2_entry": false,
    "TF": "1h",
    "AsOf": "2026-01-09 20:30",
    "PriceNow": 328.86,
    "ClosePrev": 319.58,
    "Œî-1d(now)": 2.9,
    "Œî-open(now)": 1.9,
    "MACD_slope3": 0.051079,
    "MACD_slope3_norm": 0.02774809470962994,
    "AboveMA50": true,
    "AboveMA200": true,
    "BreakRes20": true,
    "BreakRes60": true,
    "ReaceleraMACD": true,
    "DistMA50%": 9.32741365527965,
    "Support": 284.42999267578125,
    "Resist.": 330.6700134277344,
    "Name": "iShares Semiconductor ETF",
    "Asset": "ETF",
    "Sector": "",
    "Industry": "",
    "MarketCap": 2515166976.0,
    "TrailingPE": 41.4798,
    "ForwardPE": null,
    "PriceToBook": 0.7752563,
    "EVtoEBITDA": null,
    "ProfitMargin%": null,
    "ROE%": null,
    "FreeCashFlow": null,
    "TotalDebt": null,
    "DividendYield%": 0.57,
    "PayoutRatio%": null,
    "Beta": null,
    "ExpenseRatio%": null,
    "AUM": 17523822592.0,
    "Category": "Technology",
    "FundYield%": 0.0057,
    "Ret3Y%": 0.3919386,
    "Ret5Y%": 0.2017816,
    "recommendationKey": "",
    "averageAnalystRating": ""
  }
]</script>
</body></html>
